# LIKMS 법령 크롤러 초기 설정 및 의료급여법 수집

**작업일**: 2025-10-18
**작업자**: Claude Code
**상태**: ✅ 부분 완료 (1/3 법령)

---

## 📋 작업 개요

대법원 사법정보공개포털에서 의료급여 관련 법령 텍스트를 수집하는 새로운 프로젝트 시작

### 배경

HIRA 고시 문서 크롤러로 의료급여법 3종(법률, 시행령, 시행규칙) HWP 파일을 수집했으나, Upstage Document Parse API가 500 Server Error로 파싱 실패. HWP 파싱 문제를 우회하기 위해 법령 텍스트를 직접 수집하는 방법 모색.

### 목표

- 의료급여법(법률) 텍스트 수집
- 의료급여법 시행령 텍스트 수집
- 의료급여법 시행규칙 텍스트 수집

---

## 🎯 작업 내용

### 1. 프로젝트 구조 생성

```
likms/
├── __init__.py
├── scrapers/
│   ├── __init__.py
│   ├── explore_likms.py       # 국회 법률정보시스템 탐색
│   ├── explore_scourt.py      # 대법원 포털 탐색
│   ├── law_scraper.py         # 법령 수집 크롤러 (일반)
│   ├── scourt_scraper.py      # 대법원 포털 크롤러
│   ├── scourt_direct.py       # 직접 URL 접근 방식 ✅
│   ├── debug_*.py             # 디버깅 스크립트들
│   └── ...
└── README.md

data/likms/
├── exploration/               # 탐색 결과
│   ├── screenshots/
│   └── *.txt
└── laws/                      # 수집된 법령 ✅
    ├── 의료급여법.txt         # 81KB, 1,227줄
    └── 의료급여법.json

logs/likms/
└── likms_*.log
```

### 2. 법령 데이터 소스 탐색

#### 2.1 국회 법률정보시스템 (LIKMS)

**URL**: https://likms.assembly.go.kr/law

**시도**:
- ❌ 검색 기능: "의료급여법" 검색 시 결과 없음
- ❌ 현행법률 탭: 검색해도 관련 법령 발견 안됨
- 💡 깨달음: 의료급여법은 보건복지부 소관으로 국회 DB에 없을 가능성

**탐색 스크립트**:
- `explore_likms.py` - 메인 페이지 구조 분석
- `debug_search_results.py` - 검색 결과 테이블 분석
- `debug_full_search.py` - 현행법률 탭에서 검색

#### 2.2 대법원 사법정보공개포털 ✅

**URL**: https://portal.scourt.go.kr/pgp

**시도**:
- ✅ 직접 URL 접근 성공!
- 사용자 제공 URL: `w2xPath=PGP1021M04&jisCntntsSrno=2025000009651&srchwd=...`
- ✅ 의료급여법 전문 35,597 글자 추출 성공

**탐색 스크립트**:
- `explore_scourt.py` - 대법원 포털 구조 확인
- `scourt_scraper.py` - 검색 기반 크롤러 (실패)
- `scourt_direct.py` - 직접 URL 접근 (성공) ✅

---

## ✅ 성과

### 수집 완료: 의료급여법 (1/3)

| 항목 | 값 |
|------|-----|
| 법령명 | 의료급여법 |
| 법령 유형 | 법률 |
| 법령번호 | 법률 제20926호 |
| 시행일 | 2025.7.1 |
| 파일 크기 | 81KB |
| 텍스트 길이 | 35,597 글자 (1,227줄) |
| 조문 수 | 제1조~제37조 + 부칙 |
| 저장 형식 | TXT + JSON |
| 출처 | 대법원 사법정보공개포털 |

**파일 위치**:
```
data/likms/laws/
├── 의료급여법.txt
└── 의료급여법.json
```

**JSON 구조**:
```json
{
  "title": "의료급여법",
  "content": "...",
  "scraped_at": "2025-10-18T17:25:43",
  "source": "대법원 사법정보공개포털",
  "url": "https://portal.scourt.go.kr/pgp/main.on?..."
}
```

---

## ⚠️ 미완료 작업

### 시행령, 시행규칙 미수집 (2/3)

**문제**:
- 의료급여법 페이지에 시행령/시행규칙 링크 없음
- 검색 기능으로 법령을 찾지 못함
- URL 패턴(`jisCntntsSrno`) 규칙 파악 필요

**시도한 방법**:
1. ❌ 페이지 내 링크 찾기 - 링크 없음
2. ❌ 검색 기능 사용 - 검색 결과 없음
3. 💡 필요: 시행령/시행규칙 URL 직접 찾기

**대안**:
- 대법원 포털에서 "의료급여법 시행령", "의료급여법 시행규칙" 별도 검색
- 법제처 API 활용 (https://law.go.kr)
- 수동으로 URL 찾아서 제공

---

## 🛠️ 구현한 크롤러

### scourt_direct.py (메인 크롤러) ✅

```python
# 주요 기능
1. 주어진 URL로 직접 접속
2. body 전체 텍스트 추출
3. TXT + JSON 형식으로 저장
4. 시행령/시행규칙 링크 자동 탐색 (구현됨, 링크 없음)
```

**사용법**:
```bash
python likms/scrapers/scourt_direct.py
```

**특징**:
- JavaScript 동적 로딩 대응 (Playwright 사용)
- 전문 텍스트 완벽 추출
- 메타데이터 자동 수집
- 깔끔한 JSON 구조

---

## 📊 수집 통계

| 항목 | 결과 |
|------|------|
| 목표 법령 수 | 3개 |
| 성공 수집 | 1개 (33.3%) |
| 실패 | 2개 (66.7%) |
| 총 텍스트 | 35,597 글자 |
| 저장 용량 | 162KB (TXT + JSON) |

---

## 💡 기술적 발견

### 1. 대법원 포털 구조

- **URL 패턴**: `jisCntntsSrno` 파라미터가 법령 고유 ID
- **동적 로딩**: JavaScript로 콘텐츠 렌더링 → Playwright 필수
- **텍스트 품질**: 매우 깔끔, 조문 구조 완벽

### 2. 검색 vs 직접 접근

| 방법 | 성공 여부 | 비고 |
|------|-----------|------|
| 검색 기능 | ❌ 실패 | 검색 결과 없음 |
| 직접 URL | ✅ 성공 | jisCntntsSrno 필요 |

### 3. 국회 vs 대법원

| 사이트 | 의료급여법 | 비고 |
|--------|-----------|------|
| 국회 LIKMS | ❌ 없음 | 소관 부처 문제? |
| 대법원 포털 | ✅ 있음 | 전문 제공 |

---

## 🔍 비교: HWP vs 텍스트

| 항목 | HWP (HIRA) | TXT (대법원) |
|------|------------|--------------|
| 수집 완료 | ✅ 3종 모두 | ✅ 1종만 |
| 파싱 성공 | ❌ 500 Error | ✅ 즉시 사용 가능 |
| 텍스트 품질 | - | ✅ 매우 깔끔 |
| 조문 구조 | - | ✅ 완벽 |
| RAG 적용 | ❌ 불가 | ✅ 즉시 가능 |

**결론**: 대법원 포털 텍스트가 HWP보다 RAG 시스템에 훨씬 적합!

---

## 📝 다음 단계

### 우선순위 1: 시행령/시행규칙 URL 확보

**옵션 A**: 대법원 포털 수동 검색
- 직접 사이트 접속
- "의료급여법 시행령", "의료급여법 시행규칙" 검색
- URL 복사 → 크롤러에 추가

**옵션 B**: 법제처 국가법령정보센터
- https://law.go.kr
- API 또는 크롤링
- 대전센터 화재로 일시 중단 상태

**옵션 C**: 현재 1개 법령으로 진행
- 의료급여법만으로 RAG 시스템 구축 시작
- 시행령/시행규칙은 나중에 추가

### 우선순위 2: 데이터 전처리

- [  ] 텍스트 정제 (네비게이션, 메뉴 제거)
- [ ] 조문 단위 파싱
- [ ] 청크 분할 전략 수립
- [ ] 메타데이터 구조화

### 우선순위 3: RAG 시스템 준비

- [ ] 임베딩 모델 선정
- [ ] 벡터 DB 선택
- [ ] 검색 파이프라인 설계

---

## 🤝 HIRA 크롤러와 연계

### 현재 상황

| 소스 | HWP 파일 | 텍스트 |
|------|----------|--------|
| HIRA | ✅ 3종 | ❌ 파싱 실패 |
| 대법원 | - | ✅ 1종 |

### 통합 전략

1. **대법원 텍스트 우선 사용**
   - 의료급여법: 대법원 TXT (35,597자)
   - 시행령/규칙: HIRA HWP (파싱 재시도) 또는 대법원 URL 찾기

2. **메타데이터 연계**
   - HIRA `document_tree.json`의 SEQ, name, path
   - 대법원 URL, 법령번호, 시행일

3. **RAG DB 통합**
   - 법령 텍스트 (대법원)
   - 고시/행정해석 (HIRA, 44개 파싱 완료)

---

## 📂 산출물

### 코드 파일

```
likms/
├── __init__.py
├── scrapers/
│   ├── __init__.py
│   ├── scourt_direct.py         # 메인 크롤러 ✅
│   ├── explore_scourt.py        # 탐색 스크립트
│   ├── law_scraper.py           # 범용 크롤러 (미완)
│   └── debug_*.py               # 디버깅 스크립트
└── README.md
```

### 데이터 파일

```
data/likms/
├── exploration/
│   ├── screenshots/
│   │   ├── scourt_page.png      # 대법원 페이지 스크린샷
│   │   ├── 01_main_page.png     # 국회 메인 페이지
│   │   ├── 02_search_results.png
│   │   └── ...
│   ├── scourt_의료급여법.txt     # 탐색용
│   └── 의료급여법_샘플.txt        # 탐색용
│
└── laws/                         # 최종 수집 데이터 ✅
    ├── 의료급여법.txt            # 81KB
    └── 의료급여법.json           # 81KB
```

### 문서

```
docs/journal/likms/
└── 2025-10-18_initial_setup.md   # 본 문서
```

---

## 🎓 교훈

### 1. URL 패턴 파악의 중요성

검색 기능에 의존하지 말고, 직접 URL 구조를 분석하면 더 안정적

### 2. 여러 데이터 소스 탐색

국회, 대법원, 법제처 등 여러 소스 중 가장 적합한 곳 선택

### 3. HWP 파싱 대안

HWP → 텍스트 변환보다 법령 포털에서 직접 텍스트 수집이 더 효율적

### 4. JavaScript 동적 로딩 대응

Playwright 같은 브라우저 자동화 도구 필수

---

## 🔄 후속 작업

- [ ] 시행령/시행규칙 URL 확보 및 수집
- [ ] 텍스트 전처리 파이프라인 구축
- [ ] 조문 단위 파싱 및 구조화
- [ ] 법령 번호, 시행일 등 메타데이터 추출
- [ ] HIRA 데이터와 통합 스키마 설계

---

**작업 종료**: 2025-10-18
**다음 작업**: 시행령/시행규칙 URL 확보 또는 현재 데이터로 전처리 시작
